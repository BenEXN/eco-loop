<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Looop -V1.15.1</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #dee2e6;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            padding: 12px 20px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #007bff;
            color: white;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .upgrade-btn {
            background: #28a745;
        }
        
        .upgrade-btn:hover {
            background: #1e7e34;
        }
        
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
        }
        
        .log-entry {
            margin-bottom: 5px;
        }
        
        .negative { color: #dc3545; }
        .positive { color: #28a745; }
        .warning { color: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ LOOOP v1.12+ üîÑ</h1>
        
        <div class="stats" id="stats">
            <!-- Stats will be populated by JavaScript -->
        </div>
        
        <div class="actions" id="actions">
            <!-- Actions will be populated by JavaScript -->
        </div>
        
        <div class="log" id="log">
            <div class="log-entry">üéÆ Bienvenue dans Looop ! Cliquez sur "Recevoir mon don" pour commencer...</div>
        </div>
    </div>

    <script>
        const gameState = {
            money: 0,
            resources: 0,
            production: 0,
            comfort: 100,
            clicks: 0,
            hasInitialGift: false,
            hasAI: false,
            hasAutoTrader: false,
            hasProductionUpgrade: false,
            hasAutoComfort: false,
            debt: 0,
            interestRate: 0.05,
            productionMultiplier: 1,
            factories: 0,
            markets: 0,
            autoCountsAsClicks: false,
            hasPriceIndicator: false,
            interestNegotiations: 0,
            taxEnabled: false,
            lastEventClick: 0
        };

        const randomEvents = [
            // √âv√©nements Phase 1 (0-500 clics) - Rares et plut√¥t positifs
            { name: "Prime exceptionnelle", effect: () => { gameState.money += 200; log("üìà Prime exceptionnelle re√ßue ! +200‚Ç¨"); }, minClicks: 0, maxClicks: 500, probability: 0.02 },
            { name: "Ru√©e des clients", effect: () => { gameState.money += 300; log("üèÉ‚Äç‚ôÇÔ∏è Ru√©e des clients ! +300‚Ç¨"); }, minClicks: 0, maxClicks: 500, probability: 0.02 },
            { name: "Recrutement √©clair", effect: () => { gameState.productionMultiplier *= 1.1; log("‚ö° Recrutement √©clair ! Production +10%"); }, minClicks: 0, maxClicks: 500, probability: 0.02 },
            
            // √âv√©nements Phase 2 (250-1000 clics)
            { name: "Bug logiciel", effect: () => { gameState.productionMultiplier *= 0.9; log("üêõ Bug logiciel ! Production -10%"); }, minClicks: 250, maxClicks: 1000, probability: 0.03 },
            { name: "Embauche talentueuse", effect: () => { gameState.productionMultiplier *= 1.2; log("üåü Embauche d'un employ√© talentueux ! Production +20%"); }, minClicks: 250, maxClicks: 1000, probability: 0.03 },
            { name: "Panne informatique", effect: () => { gameState.productionMultiplier *= 0.8; log("üíª Panne informatique ! Production ralentie"); }, minClicks: 250, maxClicks: 1000, probability: 0.03 },
            { name: "Contr√¥le fiscal", effect: () => { gameState.money -= 500; log("üïµÔ∏è Contr√¥le fiscal ! -500‚Ç¨"); }, minClicks: 500, maxClicks: 1000, probability: 0.03 },
            { name: "Rupture de stock", effect: () => { gameState.resources = Math.max(0, gameState.resources - 10); log("üì¶ Rupture de stock temporaire !"); }, minClicks: 500, maxClicks: 1000, probability: 0.03 },
            { name: "Perte de donn√©es", effect: () => { gameState.money -= 300; log("üíæ Perte de donn√©es ! -300‚Ç¨"); }, minClicks: 500, maxClicks: 1000, probability: 0.03 },
            { name: "Audit surprise", effect: () => { gameState.money -= 400; log("üìä Audit surprise ! -400‚Ç¨"); }, minClicks: 500, maxClicks: 1000, probability: 0.03 },
            { name: "Gr√®ve du personnel", effect: () => { gameState.productionMultiplier *= 0.7; log("‚úä Gr√®ve du personnel ! Production r√©duite"); }, minClicks: 500, maxClicks: 1000, probability: 0.03 },
            { name: "Innovation externe", effect: () => { gameState.money += 600; log("üí° Innovation externe profitable ! +600‚Ç¨"); }, minClicks: 500, maxClicks: 1000, probability: 0.03 },
            
            // √âv√©nements Phase 3 (1000-3000 clics)
            { name: "Fusion d'entreprise", effect: () => { gameState.productionMultiplier *= 1.1; gameState.money += 1000; log("ü§ù Fusion d'entreprise ! Production +10% et +1000‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Perte de brevet", effect: () => { gameState.productionMultiplier *= 0.85; log("üìÑ Perte de brevet ! Co√ªt de production augment√©"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Crash boursier", effect: () => { gameState.money *= 0.8; log("üìâ Crash boursier ! -20% de monnaie"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Commande annul√©e", effect: () => { gameState.resources -= 15; gameState.money -= 200; log("‚ùå Commande annul√©e ! Perte de production et -200‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Rivalit√© concurrente", effect: () => { gameState.productionMultiplier *= 0.9; log("‚öîÔ∏è Rivalit√© concurrente ! Production -10%"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Nouvelle r√©glementation", effect: () => { gameState.money -= 800; log("üìã Nouvelle r√©glementation ! Co√ªt de mise en conformit√© -800‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Gr√®ve g√©n√©rale", effect: () => { gameState.productionMultiplier *= 0.5; log("üö´ Gr√®ve g√©n√©rale ! Toute la production bloqu√©e !"); }, minClicks: 1000, maxClicks: 3000, probability: 0.02 },
            { name: "Faillite d'un fournisseur", effect: () => { gameState.money -= 300; log("üí∏ Faillite d'un fournisseur ! Co√ªts augment√©s -300‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Fuite d'informations", effect: () => { gameState.money -= 500; log("üï≥Ô∏è Fuite d'informations strat√©giques ! -500‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Piratage informatique", effect: () => { gameState.money -= 700; log("üè¥‚Äç‚ò†Ô∏è Piratage informatique ! -700‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Subvention publique", effect: () => { gameState.money += 1200; log("üèõÔ∏è Subvention publique exceptionnelle ! +1200‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            { name: "D√©couverte march√© niche", effect: () => { gameState.money += 800; log("üéØ D√©couverte d'un march√© de niche ! +800‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            { name: "Concurrent apparition", effect: () => { gameState.productionMultiplier *= 0.85; log("üè¢ Apparition d'un concurrent ! Production -15%"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Scandale m√©diatique", effect: () => { gameState.comfort -= 20; gameState.money -= 400; log("üì∫ Scandale m√©diatique ! Confort -20 et -400‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            { name: "Campagne pub virale", effect: () => { gameState.money += 900; log("üì± Campagne de pub virale ! +900‚Ç¨"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            { name: "D√©mission employ√©-cl√©", effect: () => { gameState.productionMultiplier *= 0.8; log("üëã D√©mission d'un employ√©-cl√© ! Production -20%"); }, minClicks: 1000, maxClicks: 3000, probability: 0.04 },
            { name: "Panne d'√©lectricit√©", effect: () => { gameState.productionMultiplier *= 0.6; log("‚ö° Panne d'√©lectricit√© ! Tout s'arr√™te !"); }, minClicks: 1000, maxClicks: 3000, probability: 0.02 },
            { name: "Investisseur providentiel", effect: () => { gameState.money += 2000; log("üí∞ Investisseur providentiel ! +2000‚Ç¨ mais perte d'autonomie"); }, minClicks: 1000, maxClicks: 3000, probability: 0.02 },
            { name: "Proc√®s en justice", effect: () => { gameState.money -= 1000; gameState.comfort -= 15; log("‚öñÔ∏è Proc√®s en justice ! -1000‚Ç¨ et confort -15"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            { name: "D√©part retraite massive", effect: () => { gameState.productionMultiplier *= 0.75; log("üë¥ D√©part en retraite massive ! Production -25%"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            { name: "Innovation techno externe", effect: () => { gameState.money += 500; gameState.productionMultiplier *= 1.05; log("üî¨ Innovation technologique externe ! +500‚Ç¨ et production +5%"); }, minClicks: 1000, maxClicks: 3000, probability: 0.03 },
            
            // √âv√©nements Phase 4+ (>3000 clics) - Plus fr√©quents et puissants
            { name: "Taux int√©r√™t hausse", effect: () => { gameState.interestRate *= 1.2; log("üìà Taux d'int√©r√™t en hausse ! Cr√©dit plus cher"); }, minClicks: 3000, maxClicks: 999999, probability: 0.05 },
            { name: "Inflation g√©n√©rale", effect: () => { gameState.money *= 0.9; log("üíπ Inflation g√©n√©ralis√©e ! -10% de monnaie"); }, minClicks: 3000, maxClicks: 999999, probability: 0.05 },
            { name: "Demande export", effect: () => { gameState.money += 1500; log("üåç Demande explosive √† l'export ! +1500‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "March√© satur√©", effect: () => { gameState.productionMultiplier *= 0.7; log("üìä March√© satur√© ! Ventes impossibles"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Gr√®ve transporteurs", effect: () => { gameState.resources -= 20; log("üöö Gr√®ve des transporteurs ! Ressources bloqu√©es"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "R√©compense employeur", effect: () => { gameState.money += 800; gameState.comfort += 10; log("üèÜ R√©compense du meilleur employeur ! +800‚Ç¨ et confort +10"); }, minClicks: 3000, maxClicks: 999999, probability: 0.03 },
            { name: "Rumeur produit d√©fectueux", effect: () => { gameState.money -= 600; log("üì¢ Rumeur sur un produit d√©fectueux ! -600‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Hackathon r√©ussi", effect: () => { gameState.productionMultiplier *= 1.15; log("üíª Hackathon r√©ussi ! Production +15%"); }, minClicks: 3000, maxClicks: 999999, probability: 0.03 },
            { name: "Bug compta", effect: () => { const change = Math.random() > 0.5 ? 400 : -400; gameState.money += change; log(`üìä Bug dans la compta ! ${change > 0 ? '+' : ''}${change}‚Ç¨`); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Perte donn√©es clients", effect: () => { gameState.money -= 1200; gameState.comfort -= 25; log("üíæ Perte de donn√©es clients ! -1200‚Ç¨ et confort -25"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Panne serveur", effect: () => { gameState.productionMultiplier *= 0.5; log("üñ•Ô∏è Panne serveur ! Automatisations en pause"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Succ√®s viral r√©seaux", effect: () => { gameState.money += 2000; log("üì± Succ√®s viral sur les r√©seaux ! +2000‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.02 },
            { name: "D√©tournement interne", effect: () => { gameState.money -= 1500; log("üïµÔ∏è D√©tournement interne ! -1500‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.03 },
            { name: "Gr√®ve managers", effect: () => { gameState.productionMultiplier *= 0.6; log("üëî Gr√®ve des managers ! Actions sp√©ciales impossibles"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Rachat concurrent", effect: () => { gameState.money += 3000; gameState.productionMultiplier *= 1.1; log("üè¢ Rachat d'un concurrent ! +3000‚Ç¨ et production +10%"); }, minClicks: 3000, maxClicks: 999999, probability: 0.02 },
            { name: "Nouvel imp√¥t", effect: () => { gameState.money -= 800; log("üèõÔ∏è Nouvel imp√¥t vot√© ! -800‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Appel offre remport√©", effect: () => { gameState.money += 2500; log("üìÑ Appel d'offre remport√© ! +2500‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.02 },
            { name: "Rumeurs licenciements", effect: () => { gameState.productionMultiplier *= 0.8; gameState.comfort -= 15; log("üì∞ Rumeurs de licenciements ! Production -20% et confort -15"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "√âpid√©mie", effect: () => { gameState.productionMultiplier *= 0.7; log("ü¶† √âpid√©mie ! Absent√©isme massif"); }, minClicks: 3000, maxClicks: 999999, probability: 0.03 },
            { name: "Surcharge travail", effect: () => { gameState.productionMultiplier *= 0.75; gameState.comfort -= 20; log("üò∞ Surcharge de travail ! Efficacit√© -25% et confort -20"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Oubli √©ch√©ance", effect: () => { gameState.money -= 300; gameState.interestRate *= 1.1; log("üí≥ Oubli d'une √©ch√©ance bancaire ! -300‚Ç¨ et taux +10%"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Coup g√©nie salari√©", effect: () => { gameState.productionMultiplier *= 1.25; log("üí° Coup de g√©nie d'un salari√© ! Production +25%"); }, minClicks: 3000, maxClicks: 999999, probability: 0.02 },
            { name: "Fuite cerveau", effect: () => { gameState.productionMultiplier *= 0.85; log("üß† Fuite de cerveau ! Perte de talents -15%"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Vague candidatures", effect: () => { gameState.productionMultiplier *= 1.1; log("üìù Vague de candidatures spontan√©es ! Recrutement facilit√© +10%"); }, minClicks: 3000, maxClicks: 999999, probability: 0.03 },
            { name: "D√©tournement associ√©", effect: () => { gameState.money -= 2000; log("üí∏ D√©tournement de fonds par un associ√© ! -2000‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.02 },
            { name: "Arnaque commande", effect: () => { gameState.money -= 800; gameState.resources -= 10; log("üé≠ Arnaque √† la commande ! -800‚Ç¨ et ressources perdues"); }, minClicks: 3000, maxClicks: 999999, probability: 0.03 },
            { name: "Gr√®ve SAV", effect: () => { gameState.comfort -= 30; log("üìû Gr√®ve du SAV ! Confort -30"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "P√©nurie mat√©riel", effect: () => { gameState.productionMultiplier *= 0.8; gameState.money -= 400; log("üì¶ P√©nurie de mat√©riel ! Production -20% et co√ªts +400‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Inflation salaires", effect: () => { gameState.money -= 600; log("üí∞ Inflation des salaires ! Co√ªts employ√©s +600‚Ç¨"); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 },
            { name: "Erreur inventaire", effect: () => { const change = Math.random() > 0.5 ? 15 : -15; gameState.resources += change; log(`üìä Erreur d'inventaire ! ${change > 0 ? '+' : ''}${change} ressources`); }, minClicks: 3000, maxClicks: 999999, probability: 0.04 }
        ];

        function updateDisplay() {
            const statsContainer = document.getElementById('stats');
            const actionsContainer = document.getElementById('actions');
            
            // Update stats
            const nature = Math.max(0, 100 - Math.floor(gameState.production / 5));
            statsContainer.innerHTML = `
                <div class="stat">
                    <div class="stat-value ${gameState.money >= 0 ? 'positive' : 'negative'}">${Math.floor(gameState.money)}‚Ç¨</div>
                    <div>Monnaie</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${Math.floor(gameState.resources)}</div>
                    <div>Ressources</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${Math.floor(gameState.production)}</div>
                    <div>Production</div>
                </div>
                <div class="stat">
                    <div class="stat-value ${gameState.comfort < 30 ? 'negative' : gameState.comfort < 60 ? 'warning' : 'positive'}">${Math.floor(gameState.comfort)}</div>
                    <div>Confort</div>
                </div>
                <div class="stat">
                    <div class="stat-value ${nature < 30 ? 'negative' : nature < 60 ? 'warning' : 'positive'}">${nature}</div>
                    <div>Nature</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${gameState.clicks}</div>
                    <div>Clics</div>
                </div>
            `;
            
            // Update actions
            let buttonsHtml = '';
            
            if (!gameState.hasInitialGift) {
                buttonsHtml += `<button onclick="receiveGift()">üéÅ Recevoir mon don</button>`;
            }
            
            if (gameState.hasInitialGift) {
                buttonsHtml += `<button onclick="produce()">üè≠ Produire</button>`;
                buttonsHtml += `<button onclick="sell()">üí∞ Vendre</button>`;
                
                if (gameState.money >= 10) {
                    buttonsHtml += `<button onclick="buyComfort()">üòå Acheter confort (10‚Ç¨)</button>`;
                }
            }
            
            // Boutons d'am√©lioration
            if (gameState.clicks >= 250 && gameState.money >= -500 && !gameState.hasAI) {
                buttonsHtml += `<button onclick="buyAI()" class="upgrade-btn">ü§ñ Engager une IA (500 ‚Ç¨)</button>`;
            }
            
            if (gameState.clicks >= 500 && gameState.money >= -1000 && !gameState.hasAutoTrader) {
                buttonsHtml += `<button onclick="buyAutoTrader()" class="upgrade-btn">üìà Acheter un trader auto (1000 ‚Ç¨)</button>`;
            }
            
            if (gameState.clicks >= 600 && gameState.money >= -2000 && !gameState.hasProductionUpgrade) {
                buttonsHtml += `<button onclick="upgradeProduction()" class="upgrade-btn">‚ö° Am√©liorer production (2000 ‚Ç¨)</button>`;
            }
            
            if (gameState.clicks >= 900 && gameState.money >= -1500 && !gameState.hasAutoComfort) {
                buttonsHtml += `<button onclick="buyAutoComfort()" class="upgrade-btn">üòé Achat confort auto (1500 ‚Ç¨)</button>`;
            }
            
            if (gameState.clicks >= 750 && gameState.money >= -10000 && !gameState.autoCountsAsClicks) {
                buttonsHtml += `<button onclick="enableAutoClicks()" class="upgrade-btn">üîÑ Les automatismes comptent comme des clics (10 000 ‚Ç¨)</button>`;
            }
            
            if (gameState.clicks >= 1000 && gameState.money >= -30000 && !gameState.hasPriceIndicator) {
                buttonsHtml += `<button onclick="buyPriceIndicator()" class="upgrade-btn">üìä Indicateur de prix (30 000 ‚Ç¨)</button>`;
            }
            
            // Usines et march√©s
            if (gameState.clicks >= 1500 && gameState.money >= -20000) {
                buttonsHtml += `<button onclick="buyFactory()" class="upgrade-btn">üè≠ Usine de production √ó10 (20 000 ‚Ç¨)</button>`;
            }
            
            if (gameState.clicks >= 1600 && gameState.money >= -20000) {
                buttonsHtml += `<button onclick="buyMarket()" class="upgrade-btn">üè™ March√© de trading √ó10 vente (20 000 ‚Ç¨)</button>`;
            }
            
            // N√©gociation taux d'int√©r√™t
            if (gameState.clicks >= 3000 && gameState.interestNegotiations < 4 && gameState.comfort >= 20) {
                buttonsHtml += `<button onclick="negotiateInterest()" class="upgrade-btn">üíº N√©gocier taux d'int√©r√™t (co√ªt: 20 confort)</button>`;
            }
            
            actionsContainer.innerHTML = buttonsHtml;
        }

        function log(message) {
            const logContainer = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `<span style="opacity: 0.7">[${new Date().toLocaleTimeString()}]</span> ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // Garder seulement les 50 derniers messages
            while (logContainer.children.length > 50) {
                logContainer.removeChild(logContainer.firstChild);
            }
        }

        function receiveGift() {
            gameState.money = 100;
            gameState.hasInitialGift = true;
            gameState.clicks++;
            log("üéÅ Don initial re√ßu ! +100‚Ç¨");
            updateDisplay();
            checkRandomEvent();
        }

        function produce() {
            if (gameState.comfort <= 0) {
                log("‚ùå Impossible de produire ! Confort trop bas");
                return;
            }
            
            const productionAmount = (1 + gameState.factories) * gameState.productionMultiplier;
            gameState.resources += productionAmount;
            gameState.production += productionAmount;
            gameState.comfort = Math.max(0, gameState.comfort - 1);
            gameState.clicks++;
            log(`üè≠ Production : +${productionAmount.toFixed(1)} ressources`);
            updateDisplay();
            checkRandomEvent();
        }

        function sell() {
            if (gameState.resources <= 0) {
                log("‚ùå Aucune ressource √† vendre !");
                return;
            }
            
            const sellAmount = Math.min(gameState.resources, 1 + gameState.markets);
            const price = gameState.hasPriceIndicator ? Math.random() * 20 + 10 : Math.random() * 15 + 5;
            const earnings = sellAmount * price;
            
            gameState.resources -= sellAmount;
            gameState.money += earnings;
            gameState.clicks++;
            log(`üí∞ Vente : ${sellAmount.toFixed(1)} ressources pour ${earnings.toFixed(2)}‚Ç¨`);
            updateDisplay();
            checkRandomEvent();
        }

        function buyComfort() {
            if (gameState.money >= 10) {
                gameState.money -= 10;
                gameState.comfort = Math.min(100, gameState.comfort + 5);
                gameState.clicks++;
                log("üòå Confort achet√© ! +5 confort");
                updateDisplay();
                checkRandomEvent();
            }
        }

        function buyAI() {
            if (gameState.money >= -500) {
                gameState.money -= 500;
                gameState.hasAI = true;
                log("ü§ñ IA engag√©e ! Production automatique activ√©e");
                updateDisplay();
            }
        }

        function buyAutoTrader() {
            if (gameState.money >= -1000) {
                gameState.money -= 1000;
                gameState.hasAutoTrader = true;
                log("üìà Trader automatique achet√© ! Vente automatique activ√©e");
                updateDisplay();
            }
        }

        function upgradeProduction() {
            if (gameState.money >= -2000) {
                gameState.money -= 2000;
                gameState.hasProductionUpgrade = true;
                gameState.productionMultiplier *= 1.5;
                log("‚ö° Production am√©lior√©e ! Efficacit√© +50%");
                updateDisplay();
            }
        }

        function buyAutoComfort() {
            if (gameState.money >= -1500) {
                gameState.money -= 1500;
                gameState.hasAutoComfort = true;
                log("üòé Achat confort automatique activ√© !");
                updateDisplay();
            }
        }

        function enableAutoClicks() {
            if (gameState.money >= -10000) {
                gameState.money -= 10000;
                gameState.autoCountsAsClicks = true;
                log("üîÑ Les automatismes comptent maintenant comme des clics !");
                updateDisplay();
            }
        }

        function buyPriceIndicator() {
            if (gameState.money >= -30000) {
                gameState.money -= 30000;
                gameState.hasPriceIndicator = true;
                log("üìä Indicateur de prix achet√© ! Meilleurs prix de vente !");
                updateDisplay();
            }
        }

        function buyFactory() {
            if (gameState.money >= -20000) {
                gameState.money -= 20000;
                gameState.factories++;
                log(`üè≠ Usine construite ! Production √ó${gameState.factories + 1}`);
                updateDisplay();
            }
        }

        function buyMarket() {
            if (gameState.money >= -20000) {
                gameState.money -= 20000;
                gameState.markets++;
                log(`üè™ March√© ouvert ! Vente √ó${gameState.markets + 1}`);
                updateDisplay();
            }
        }

        function negotiateInterest() {
            if (gameState.comfort >= 20) {
                gameState.comfort -= 20;
                gameState.interestRate *= 0.8;
                gameState.interestNegotiations++;
                log(`üíº Taux d'int√©r√™t n√©goci√© ! Nouveau taux: ${(gameState.interestRate * 100).toFixed(2)}%`);
                updateDisplay();
            }
        }

        function checkRandomEvent() {
            // √âv√©nements plus fr√©quents selon la phase
            let eventChance = 0.02; // Base 2%
            if (gameState.clicks > 3000) eventChance = 0.08; // 8% apr√®s 3000 clics
            else if (gameState.clicks > 1000) eventChance = 0.05; // 5% apr√®s 1000 clics
            else if (gameState.clicks > 500) eventChance = 0.03; // 3% apr√®s 500 clics
            
            if (Math.random() < eventChance && gameState.clicks - gameState.lastEventClick > 50) {
                const possibleEvents = randomEvents.filter(event => 
                    gameState.clicks >= event.minClicks && 
                    gameState.clicks <= event.maxClicks &&
                    Math.random() < event.probability
                );
                
                if (possibleEvents.length > 0) {
                    const randomEvent = possibleEvents[Math.floor(Math.random() * possibleEvents.length)];
                    randomEvent.effect();
                    gameState.lastEventClick = gameState.clicks;
                    updateDisplay();
                }
            }
        }

        function handleDebt() {
            if (gameState.money < 0) {
                gameState.debt = Math.abs(gameState.money);
                const interest = gameState.debt * gameState.interestRate;
                gameState.money -= interest;
                if (Math.random() < 0.1) {
                    log(`üí≥ Int√©r√™ts sur la dette : -${interest.toFixed(2)}‚Ç¨`);
                }
            }
        }

        function checkCrises() {
            if (gameState.comfort < 10) {
                log("üö® CRISE SOCIALE ! Confort critique !");
                gameState.productionMultiplier *= 0.8;
            }
            
            const nature = 100 - Math.floor(gameState.production / 5);
            if (nature < 10) {
                log("üåç CRISE √âCOLOGIQUE ! Impact environnemental critique !");
                gameState.productionMultiplier *= 0.9;
            }
            
            if (gameState.debt > 10000) {
                log("üí∏ CRISE FINANCI√àRE ! Dette trop √©lev√©e !");
                gameState.productionMultiplier *= 0.7;
            }
        }

        // Automation
        setInterval(() => {
            if (gameState.hasAI && gameState.hasInitialGift) {
                produce();
                if (gameState.autoCountsAsClicks) {
                    gameState.clicks++;
                }
            }
            if (gameState.hasAutoTrader && gameState.hasInitialGift) {
                sell();
                if (gameState.autoCountsAsClicks) {
                    gameState.clicks++;
                }
            }
            if (gameState.hasAutoComfort && gameState.hasInitialGift) {
                if (gameState.money >= 10) {
                    gameState.money -= 10;
                    gameState.comfort = Math.min(100, gameState.comfort + 5);
                    if (gameState.autoCountsAsClicks) {
                        gameState.clicks++;
                    }
                }
            }
            updateDisplay();
        }, 2000);

        // Debt and crisis management
        setInterval(() => {
            handleDebt();
            checkCrises();
            updateDisplay();
        }, 5000);

    </script>
</body>
</html>
