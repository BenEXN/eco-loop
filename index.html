<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Looop v0.3 ‚Äì Compteur & Am√©lioration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root { --bg:#f3f3f3; --card:#fff; --ink:#1c1c1c; --accent:#2d7ef7; --ok:#28a745; }
    * { box-sizing: border-box; }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg); color:var(--ink); display:flex; min-height:100vh; align-items:center; justify-content:center;
    }
    .app{
      width:min(680px, 92vw); background:var(--card); border-radius:16px; padding:20px 18px; box-shadow: 0 10px 30px rgba(0,0,0,.06);
    }
    h1{ margin:0 0 12px; font-weight:700; font-size:clamp(22px, 3.5vw, 28px); }
    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px 14px; margin:6px 0 12px; }
    .stock{ padding:10px 12px; border:1px solid #ececec; border-radius:10px; background:#fafafa; font-size:15px; }
    .stock b{ display:block; font-size:12px; opacity:.7; margin-bottom:4px; font-weight:600; letter-spacing:.02em; }
    .actions{ display:flex; flex-wrap:wrap; gap:10px; margin:12px 0 4px; }
    button{
      appearance:none; border:0; border-radius:12px; padding:12px 16px; font-size:15px; font-weight:600; cursor:pointer;
      background:#151515; color:#fff; transition:transform .04s ease, opacity .2s ease; }
    button.secondary{ background:#e9eefc; color:#0c2461; }
    #upgrade-btn{ background:var(--ok); }
    button:active{ transform: translateY(1px); }
    .meta{ margin-top:10px; font-size:14px; opacity:.8; }
  </style>
</head>
<body>
  <main class="app">
    <h1>üåç Looop <span style="font-weight:600; opacity:.6;">v0.3</span></h1>

    <section class="grid">
      <div class="stock"><b>Ressources</b><span id="nature">40</span></div>
      <div class="stock"><b>Confort</b><span id="confort">0</span></div>
      <div class="stock"><b>Production</b><span id="production">0</span></div>
      <div class="stock"><b>Monnaie (‚Ç¨)</b><span id="money">10</span></div>
    </section>

    <section class="actions">
      <button id="produce-btn" onclick="produce()">üõ†Ô∏è Produire</button>
      <button class="secondary" id="sell-btn" onclick="sell()">üí∂ Vente</button>
      <button id="upgrade-btn" style="display:none" onclick="upgradeProd()">‚≠ê Am√©liorer la production<br/>(co√ªt ressource 5 ‚Üí 4)</button>
    </section>

    <div class="meta">
      Actions effectu√©es : <span id="clicks">0</span>
      <span id="hint" style="margin-left:8px;"></span>
    </div>
  </main>

  <script>
    // √âTAT INITIAL
    let nature = 40;      // ressources
    let confort = 0;      // "capital social" renomm√©
    let production = 0;   // stock de produits non vendus
    let money = 10;       // monnaie classique (‚Ç¨)
    let clicks = 0;       // compteur d‚Äôactions
    let prodCost = 5;     // co√ªt en ressources pour produire
    let upgradeUsed = false;

    // UTIL
    const $ = (id) => document.getElementById(id);
    const log = (...a) => console.log('[Looop]', ...a);

    function updateUI() {
      $("nature").textContent = nature;
      $("confort").textContent = confort;
      $("production").textContent = production;
      $("money").textContent = money;
      $("clicks").textContent = clicks;

      // D√©clenche le palier : afficher le bouton d'am√©lioration quand Production ‚â• 50 et pas encore pris
      if (production >= 50 && !upgradeUsed) {
        $("upgrade-btn").style.display = "";
        $("hint").textContent = "üéØ Am√©lioration disponible : atteinte de 50 en production.";
      } else if (upgradeUsed) {
        $("hint").textContent = "‚úÖ Am√©lioration appliqu√©e (co√ªt ressource = " + prodCost + ").";
      } else {
        $("hint").textContent = "";
      }

      // (s√©curit√© UX) : griser les boutons quand pas possible
      $("produce-btn").disabled = !(nature >= prodCost && money >= 1);
      $("sell-btn").disabled = !(production >= 1);
    }

    function produce() {
      if (nature >= prodCost && money >= 1) {
        nature -= prodCost;     // consomme ressources
        money -= 1;             // paie co√ªt mon√©taire
        production += 1;        // cr√©e 1 produit
        clicks += 1;            // compte l‚Äôaction
        log('Produire ‚Üí -'+prodCost+' ressources, -1 ‚Ç¨, +1 production');
        updateUI();
      } else {
        alert("Pas assez de ressources ou de monnaie !");
      }
    }

    function sell() {
      if (production >= 1) {
        const vendu = 1;        // vente unitaire (simple pour tester)
        production -= vendu;
        money += 2 * vendu;     // 2 ‚Ç¨ par produit
        confort += 1 * vendu;   // +1 confort par produit vendu
        clicks += 1;
        log('Vente ‚Üí +'+(2*vendu)+' ‚Ç¨, +' + (1*vendu) + ' confort, -'+vendu+' production');
        updateUI();
      } else {
        alert("Aucun produit √† vendre !");
      }
    }

    function upgradeProd() {
      if (upgradeUsed) return;
      // Ici, l‚Äôam√©lioration est gratuite (palier). On ne touche pas √† l‚Äôargent.
      prodCost = 4;
      upgradeUsed = true;
      $("upgrade-btn").style.display = "none";
      clicks += 1; // on compte aussi le clic d‚Äôam√©lioration
      log('Am√©lioration appliqu√©e ‚Üí co√ªt de production passe √† 4 ressources.');
      updateUI();
      // petit feedback
      alert("Am√©lioration activ√©e ! La production co√ªte d√©sormais 4 ressources.");
    }

    // init
    updateUI();
  </script>
</body>
</html>
