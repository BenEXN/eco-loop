<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Looop v1.23 ‚Äì Cr√©dit centralis√©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { background: #f3f3f3; font-family: sans-serif; margin:0; padding:0; }
    h1 { text-align: center; margin: 25px 0 10px; }
    .container { display: flex; justify-content: center; align-items: flex-start; margin: 0 auto 18px auto; max-width: 950px; gap: 24px;}
    .category { background: #fff; border-radius: 18px; box-shadow: 0 4px 24px #0001; flex: 1; padding: 32px 18px 18px 18px; margin: 0 6px; min-width: 250px; max-width: 320px; min-height: 250px; display: flex; flex-direction: column; align-items: center;}
    .cat-title { font-size: 1.25em; margin-bottom: 20px; font-weight: bold; letter-spacing: 1px;}
    .stock { font-size: 1.1em; margin-bottom: 10px;}
    .products-box { background: #f7f7fa; border: 2px solid #dde1eb; border-radius: 10px; color: #333; margin-bottom: 10px; padding: 10px 28px; font-size: 1.2em; font-weight: bold; letter-spacing: 1px; box-shadow: 0 1px 4px #ddd5; min-width: 110px; text-align: center;}
    .message-box { border-radius: 10px; margin: 8px 0 14px 0; padding: 11px 14px 11px 14px; font-weight: bold; font-size: 1.08em; box-shadow: 0 1px 4px #0002; text-align: center; min-width: 130px; max-width: 260px; word-break: break-word; line-height: 1.25em;}
    .msg-orange { background: #ffe9cf; color: #d2691e; border: 2px solid #f5c387;}
    .msg-blue { background: #e7f4ff; color: #0978c6; border: 2px solid #7cc8fa;}
    .msg-red { background: #ffe3e3; color: #c00; border: 2px solid #e48888;}
    .msg-brown { background: #fff4d6; color: #be8c00; border: 2px solid #e2c071;}
    .msg-green { background: #e8f5e8; color: #2e7d32; border: 2px solid #81c784;}
    .btn-row { margin: 18px 0 0 0;}
    button { font-size: 1em; padding: 10px 18px; margin: 5px 0; border-radius: 14px; border: none; background: #ededed; color: #111; cursor: pointer; transition: background 0.2s;}
    .btn-yellow { background: #FFD600; color: #222; font-weight: bold;}
    .btn-annuler { background: #aaa; color: #fff; }
    .btn-credit { background: #ff6b35; color: #fff; font-weight: bold;}
    .btn-evolution { background: #4CAF50; color: #fff; font-weight: bold;}
    .debug-row { margin: 0 0 32px 0; display: flex; justify-content: center; gap: 10px;}
    .message { font-weight: bold; min-height: 24px; margin: 10px 0;}
    #clics-container { text-align: center; margin: 25px 0 0 0; font-size: 1.2em; font-weight: bold; color: #333;}
    #don-btn { margin-top: 10px; background: #FFD600; color: #222; font-weight: bold; border: none; border-radius: 8px; font-size: 1.1em; padding: 14px 20px;}
    #triche-sep { border: none; border-top: 3px solid #222; margin: 38px auto 12px auto; width: 94vw; max-width: 1000px;}
    #triche-label { text-align: left; font-size:1.13em; font-weight:normal; letter-spacing:1px; margin: 0 0 12px 0; color:#111; width: 95vw; max-width: 1000px; margin-left: auto; margin-right: auto;}
    .hidden {display:none;}
  </style>
</head>
<body>
  <h1>üåç Looop <span style="font-size:0.7em;color:#777;">v1.23 Cr√©dit centralis√©</span></h1>
  <div class="container">
    <div class="category">
      <div class="cat-title">üå± Environnement</div>
      <div class="stock">Ressources : <span id="nature">3000</span></div>
      <div id="alert-crise" class="message-box msg-orange" style="display:none;"></div>
      <div class="btn-row">
        <button id="produce-btn" onclick="produce()">üõ†Ô∏è Produire</button>
      </div>
    </div>
    <div class="category">
      <div class="cat-title">ü§ñ Exosomatisation</div>
      <div class="stock">Confort : <span id="confort">0</span></div>
      <div class="products-box">
        Produits cr√©√©s<br>
        <span id="production">0</span>
      </div>
      <div id="social-crise" class="message-box msg-brown" style="display:none;"></div>
      <div class="btn-row">
        <button id="comfort-btn" onclick="triggerBuy('confort')" style="display:none;">üõãÔ∏è Achat (100 ‚Ç¨)</button>
        <button id="sell-btn" onclick="sell()">üí∂ Vendre</button>
      </div>
    </div>
    <div class="category">
      <div class="cat-title">üí∂ √âconomie</div>
      <div class="stock" id="money-row" style="display:none;">
        Monnaie (‚Ç¨) : <span id="money">10</span>
      </div>
      <button id="don-btn" onclick="receiveDon()">Recevoir mon don</button>
      <button id="credit-btn" onclick="activateCredit()" style="display:none;" class="btn-credit">üí≥ Effectuer un cr√©dit</button>
      <div class="btn-row">
        <button id="ouvrier-btn" onclick="triggerBuy('ia')" style="display:none;">ü§ñ Engager une IA (500 ‚Ç¨)</button>
        <button id="trader-btn" onclick="triggerBuy('trader')" style="display:none;">ü§ñ Trader automatique (1 000 ‚Ç¨)</button>
        <button id="comfort-auto-btn" onclick="triggerBuy('confortAuto')" style="display:none;">üîÑ Achat auto confort (2 000 ‚Ç¨)</button>
        <button id="upgrade-btn2" onclick="triggerBuy('upgradeProd')" style="display:none;">üí† Am√©liorer la production (2 000 ‚Ç¨)</button>
        <button id="automatisms-btn" onclick="triggerBuy('automatismsClics')" style="display:none;">‚ö° Automatismes = clics (10 000 ‚Ç¨)</button>
        <button id="centre-commercial-btn" onclick="triggerBuy('centreCommercial')" style="display:none;">üè¨ Centre commercial (5 000 ‚Ç¨)</button>
        <button id="price-indicator-btn" onclick="triggerBuy('priceIndicator')" style="display:none;">üìä Indicateur de prix (30 000 ‚Ç¨)</button>
        <button id="evolution-btn" onclick="evolution()" style="display:none;" class="btn-evolution">üå± √âvolution √©conomique</button>
      </div>
    </div>
  </div>
  <div class="message" id="message"></div>
  <div id="clics-container">Clics/actions : <span id="clicks">0</span></div>
  <hr id="triche-sep">
  <div id="triche-label">Triche</div>
  <div class="debug-row">
    <button class="btn-yellow" onclick="addMoney()">+1000 cr√©dits (test)</button>
    <button class="btn-yellow" onclick="addOneNature()">+100 ressources (test)</button>
    <button class="btn-yellow" onclick="addClicks50()">Clics +50 (test)</button>
  </div>
  <script>
    // --- √âtats, constantes et persistance ---
    var gameState = {
      nature: 3000, confort: 0, production: 0, money: 10, clicks: 0, monnaieActive: false, jeuBloque: false, creditUnlocked: false,
      ia: 0, traderAuto: 0, confortAuto: 0, centreCommercial: 0, techLevel: 0, productionMultiplier: 1,
      automatismsGenerateClicks: false, priceIndicatorActive: false, ehActivated: false
    };
    var prices = { confort: 100, ia: 500, trader: 1000, confortAuto: 2000, upgradeProd: 2000, automatismsClics: 10000, priceIndicator: 30000, centreCommercial: 5000 };
    var purchaseFuncs = {
      confort: buyConfort, ia: buyIA, trader: buyTrader, confortAuto: buyConfortAuto,
      upgradeProd: buyUpgradeProd, automatismsClics: buyAutomatismsClics, priceIndicator: buyPriceIndicator, centreCommercial: buyCentreCommercial
    };
    var pendingPurchase = null;
    function loadGameState() { try { var s = localStorage.getItem('looopGameState'); if (s) Object.assign(gameState, JSON.parse(s)); } catch(e){} }
    function saveGameState() { try { localStorage.setItem('looopGameState', JSON.stringify(gameState)); } catch(e){} }
    // --- Achats centralis√©s : test de cr√©dit ---
    function triggerBuy(type) {
      var price = prices[type];
      if (gameState.creditUnlocked) { purchaseFuncs[type](); return; }
      if (gameState.money >= price) { purchaseFuncs[type](); return; }
      if (!gameState.creditUnlocked && document.getElementById("credit-btn").style.display === "none") {
        pendingPurchase = type;
        document.getElementById("credit-btn").style.display = "block";
        updateUI("Fonds insuffisants : effectuez un cr√©dit pour d√©bloquer tous les achats.");
      }
    }
    function activateCredit() {
      gameState.creditUnlocked = true;
      document.getElementById("credit-btn").style.display = "none";
      saveGameState();
      if (pendingPurchase) { purchaseFuncs[pendingPurchase](); pendingPurchase = null; }
      updateUI("üí≥ Cr√©dit activ√©. Achats sans limite !");
    }
    // --- Toutes les fonctions d'achat classiques (jamais de test de solde ici !) ---
    function buyConfort() { gameState.money -= prices.confort; gameState.confort += 1; gameState.clicks++; saveGameState(); updateUI("Confort +1"); }
    function buyIA() { gameState.money -= prices.ia; gameState.ia++; gameState.clicks++; saveGameState(); updateUI("IA +1"); }
    function buyTrader() { gameState.money -= prices.trader; gameState.traderAuto++; gameState.clicks++; saveGameState(); updateUI("Trader +1"); }
    function buyConfortAuto() { gameState.money -= prices.confortAuto; gameState.confortAuto++; gameState.clicks++; saveGameState(); updateUI("Achat auto confort +1"); }
    function buyCentreCommercial() { gameState.money -= prices.centreCommercial; gameState.centreCommercial++; gameState.clicks++; saveGameState(); updateUI("Centre commercial +1"); }
    function buyUpgradeProd() { gameState.money -= prices.upgradeProd; gameState.techLevel++; gameState.productionMultiplier *= 1.5; gameState.clicks++; saveGameState(); updateUI("Production am√©lior√©e"); }
    function buyAutomatismsClics() { gameState.money -= prices.automatismsClics; gameState.automatismsGenerateClicks = true; gameState.clicks++; saveGameState(); updateUI("Automatismes = clics"); }
    function buyPriceIndicator() { gameState.money -= prices.priceIndicator; gameState.priceIndicatorActive = true; gameState.clicks++; saveGameState(); updateUI("Indicateur de prix activ√©"); }
    // --- Le reste de ton jeu ---
    function produce() { var cost = 5; if (gameState.nature >= cost) { gameState.nature -= cost; gameState.production += 1; gameState.clicks++; saveGameState(); updateUI("Production +1"); } }
    function sell() { if (gameState.production <= 0) { updateUI("Aucun produit √† vendre"); return; } var price = 1; gameState.money += price; gameState.production -= 1; gameState.clicks++; if (!gameState.monnaieActive) { gameState.monnaieActive = true; document.getElementById("money-row").style.display = "block"; } saveGameState(); updateUI("Vente +" + price + "‚Ç¨"); }
    function receiveDon() { gameState.money = 1000; gameState.clicks++; document.getElementById("don-btn").style.display = "none"; saveGameState(); updateUI("Don re√ßu : 1000‚Ç¨"); }
    function addMoney() { gameState.money += 1000; saveGameState(); updateUI("Test : +1000‚Ç¨"); }
    function addOneNature() { gameState.nature += 100; saveGameState(); updateUI("Test : +100 ressources"); }
    function addClicks50() { gameState.clicks += 50; saveGameState(); updateUI("Test : +50 clics"); }
    function updateUI(msg) {
      document.getElementById("nature").textContent = gameState.nature;
      document.getElementById("confort").textContent = gameState.confort;
      document.getElementById("production").textContent = gameState.production;
      document.getElementById("money").textContent = gameState.money;
      document.getElementById("clicks").textContent = gameState.clicks;
      if (msg) document.getElementById("message").textContent = msg;
      if (gameState.creditUnlocked) document.getElementById("credit-btn").style.display = "none";
    }
    window.onload = function() {
      loadGameState();
      updateUI("");
    }
  </script>
</body>
</html>
